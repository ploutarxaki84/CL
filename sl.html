<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Super League - League Phase</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Inter:wght@300;400;700;900&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at top, #1a1a1a 0%, #000 70%);
      color: #f8fafc;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    .header-title {
      font-family: 'Black Ops One', system-ui;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #facc15 10%, #fde047 50%, #fff 90%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: drop-shadow(0 0 8px rgba(250, 204, 21, 0.4));
    }

    .glass-card {
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid rgba(250, 204, 21, 0.35);
      border-radius: 1rem;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
      overflow: hidden;
    }

    .match-row {
      display: grid;
      grid-template-columns: 2fr 1fr 0.7fr;
      align-items: center;
      padding: 1.25rem 1rem;
      border-bottom: 1px solid rgba(250, 204, 21, 0.25);
    }

    .match-row:last-child { border-bottom: none; }

    .analysis-badge-yellow {
      font-size: 9px;
      font-weight: 900;
      color: #facc15;
      background: rgba(250, 204, 21, 0.1);
      padding: 2px 6px;
      border: 1px solid rgba(250, 204, 21, 0.3);
      border-radius: 4px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .pred-group {
      display: inline-flex;
      align-items: stretch;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(250, 204, 21, 0.25);
      border-radius: 6px;
      overflow: hidden;
    }

    .pred-box-inner {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 3px 8px;
      min-width: 38px;
      font-weight: 900;
      font-size: 13px;
    }

    .first-box { color: #ffffff; }
    .second-box { color: #facc15; background: rgba(250, 204, 21, 0.15); }
    .v-divider { width: 1px; background: rgba(250, 204, 21, 0.3); margin: 4px 0; }

    .team-names {
      font-size: 10px;
      font-weight: 700;
      color: #e5e7eb;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      margin-bottom: 4px;
    }

    @keyframes ball-slide {
      0% { transform: translateX(-40px) rotate(0deg); }
      50% { transform: translateX(40px) rotate(360deg); }
      100% { transform: translateX(-40px) rotate(720deg); }
    }

    .sliding-ball {
      display: inline-block;
      font-size: 1.2rem;
      animation: ball-slide 3s infinite linear;
      margin-top: 8px;
      color: #facc15;
    }

    @keyframes score-hit {
      0%, 100% { transform: scale(1); filter: brightness(1); }
      50% { transform: scale(1.15); filter: brightness(1.3); box-shadow: 0 0 15px rgba(250,204,21,0.4); }
    }

    .score-display {
      display: inline-block;
      font-size: 16px;
      font-weight: 900;
      background: #ffffff;
      color: #000000;
      padding: 4px 14px;
      border-radius: 8px;
      margin-bottom: 8px;
      animation: score-hit 2.5s infinite ease-in-out;
      letter-spacing: 2px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      text-shadow: 0px 0px 1px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body class="p-4 md:p-8">
<div class="max-w-2xl mx-auto">

  <header class="text-center mb-10 overflow-hidden">
    <div class="flex items-center justify-center gap-4 mb-2">
      <h1 class="text-4xl md:text-5xl header-title">SUPER LEAGUE</h1>
    </div>

    <div class="relative inline-block">
      <p class="text-yellow-300 text-sm font-black tracking-widest uppercase bg-slate-900/40 inline-block px-4 py-1 rounded-full border border-yellow-500 relative z-10">
        <i class="far fa-calendar-alt mr-2 text-yellow-300"></i>17–18/1/2026 — 19η ΑΓΩΝΙΣΤΙΚΗ
      </p>
      <div class="block">
        <span class="sliding-ball">⚽</span>
      </div>
    </div>
  </header>

  <div id="stats-grid" class="grid grid-cols-3 gap-3 mb-8"></div>
  <div id="round-container" class="glass-card"></div>

</div>

<script>
const matchesData = [
  { teams: "ΑΕΛ - ΑΡΗΣ", p1:"2",  p2:"",   g1:"X",  g2:"",   n1:"",  n2:"", score:"1-0" },
  { teams: "ΠΑΟΚ - ΟΦΗ", p1:"1",  p2:"",   g1:"GG", g2:"",   n1:"",  n2:"", score:"3-0" },
  { teams: "ΑΕΚ - ΠΑΟ",  p1:"X",  p2:"",   g1:"NG", g2:"",   n1:"",  n2:"", score:"4-0" },
  { teams: "Παναιτωλικός - Λεβαδειακός", p1:"X", p2:"2", g1:"1", g2:"X", n1:"", n2:"", score:"1-3" },
  { teams: "Βόλος - Ατρόμητος", p1:"1", p2:"X", g1:"2", g2:"X", n1:"", n2:"", score:"0-3" }
];

function calculateResults(scoreStr) {
  if (!scoreStr) return { signs: [], ou: "" };
  const [h, a] = scoreStr.split('-').map(Number);
  const signs = [];

  if (h > a) signs.push("1");
  else if (a > h) signs.push("2");
  else signs.push("X");

  signs.push(h > 0 && a > 0 ? "GG" : "NG");

  const ou = (h + a) > 2.5 ? "OV" : "UN";

  return { signs, ou };
}

function checkWin(prediction, results) {
  if (!prediction || results.signs.length === 0) return false;
  const parts = prediction.split(/\s+/).filter(p => p !== "");
  return parts.some(p => results.signs.includes(p) || p.toUpperCase() === results.ou);
}

function formatDual(a, b) {
  if (!a && !b) return `<div class="text-slate-700 font-bold ml-2">—</div>`;
  if (a && !b) {
    return `
      <div class="pred-group">
        <div class="pred-box-inner first-box">${a}</div>
      </div>
    `;
  }
  return `
    <div class="pred-group">
      <div class="pred-box-inner first-box">${a}</div>
      <div class="v-divider"></div>
      <div class="pred-box-inner second-box">${b}</div>
    </div>
  `;
}

function render() {
  const statsGrid = document.getElementById('stats-grid');
  const roundContainer = document.getElementById('round-container');
  let stats = { p: 0, g: 0, n: 0 };
  let matchesHtml = "";

  matchesData.forEach(m => {
    const results = calculateResults(m.score);

    const predP = `${m.p1} ${m.p2}`.trim();
    const predG = `${m.g1} ${m.g2}`.trim();
    const predN = `${m.n1} ${m.n2}`.trim();

    const winP = checkWin(predP, results);
    const winG = checkWin(predG, results);
    const winN = checkWin(predN, results);

    if (winP) stats.p++;
    if (winG) stats.g++;
    if (winN) stats.n++;

    let winners = [];
    if (winP) winners.push("Π");
    if (winG) winners.push("Γ");
    if (winN) winners.push("Ν");
    const winText = winners.length ? winners.join('-') : "➖";

    matchesHtml += `
      <div class="match-row">
        <div>
          <div class="team-names">${m.teams}</div>
          <div class="flex flex-col gap-2">
            <div class="flex items-center text-[13px]">
              <span class="font-black text-yellow-400 w-8">Π:</span>
              ${formatDual(m.p1, m.p2)}
            </div>
            <div class="flex items-center text-[13px]">
              <span class="font-black text-yellow-400 w-8">Γ:</span>
              ${formatDual(m.g1, m.g2)}
            </div>
            <div class="flex items-center text-[13px]">
              <span class="font-black text-yellow-400 w-8">Ν:</span>
              ${formatDual(m.n1, m.n2)}
            </div>
          </div>
        </div>

        <div class="text-center flex flex-col items-center">
          <span class="score-display">${m.score || "—"}</span>
          <div class="flex flex-wrap justify-center gap-1">
            ${results.signs.map(r => `<span class="analysis-badge-yellow">${r}</span>`).join('')}
            ${results.ou ? `<span class="analysis-badge-yellow">${results.ou}</span>` : ""}
          </div>
        </div>

        <div class="text-right">
          <span class="text-xs font-black ${winText === '➖' ? 'text-slate-700' : 'text-yellow-400'}">${winText}</span>
        </div>
      </div>
    `;
  });

  roundContainer.innerHTML = matchesHtml;

  statsGrid.innerHTML = `
    <div class="bg-slate-900 border-b-2 border-yellow-400 p-2 rounded text-center">
      <div class="text-[9px] text-slate-400 uppercase font-black">Παναγιώτης</div>
      <div class="text-xl font-black text-white" data-player="Π">${stats.p}</div>
    </div>

    <div class="bg-slate-900 border-b-2 border-yellow-400 p-2 rounded text-center">
      <div class="text-[9px] text-slate-400 uppercase font-black">Γιώργος</div>
      <div class="text-xl font-black text-white" data-player="Γ">${stats.g}</div>
    </div>

    <div class="bg-slate-900 border-b-2 border-yellow-400 p-2 rounded text-center">
      <div class="text-[9px] text-slate-400 uppercase font-black">Νικόλας</div>
      <div class="text-xl font-black text-white" data-player="Ν">${stats.n}</div>
    </div>
  `;
}

function detectWinner() {
  const elements = document.querySelectorAll("[data-player]");
  let max = -1;
  let winner = "";

  elements.forEach(el => {
    const value = parseInt(el.textContent.trim(), 10);
    const player = el.getAttribute("data-player");

    if (!isNaN(value) && value > max) {
      max = value;
      winner = player;
    }
  });

  return { winner, points: max };
}

function sendWinner() {
  const result = detectWinner();

  window.parent.postMessage({
    type: "winner",
    league: "SL",
    winner: result.winner,
    points: result.points
  }, "*");
}

window.onload = () => {
  render();

  window.parent.postMessage({
    type: "setHeight",
    height: document.body.scrollHeight
  }, "*");

  setTimeout(sendWinner, 300);
};
</script>

</body>
</html>
